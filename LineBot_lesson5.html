<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
  <meta charset="utf-8">
   <title>LineBot第五堂課</title>
   <meta name="description" content="提供物理與程式學習的教學與心得">
  <link rel="icon" type="image/png" href="images/GuidephyNotes-sLogo.png">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- CSS -->
  <link rel="stylesheet" href="https://unpkg.com/ress/dist/ress.min.css">
  <link href="https://fonts.googleapis.com/css?family=Philosopher" rel="stylesheet">
  <link href="css/style.css" rel="stylesheet">
  
  <meta name="google-site-verification" content="tvvXxbI18opHJBKJIQdDbub-eFv-PrXfNGiKNXskiL8" />
   <script src="JS/menu.js"></script>
  
</head>

<body>
  <div id="news" class="big-bg">
    <header class="page-header wrapper">
      <h1><a href="https://guidephy.github.io"><img class="logo" src="images/GuidephyNotesLogo.png" alt="Guidephy學習教室首頁"></a></h1>
      <nav>
        <ul class="main-nav">
         <ul class="main-nav">
          <li class="dropdown"><a href="javascript:void(0)" class="dropbtn" onclick="myFunction1()">學習講義</a>
              <div class="dropdown-content" id="myDropdown1">
                  <a href="test.html">高中物理</a>
                  <a href="program.html">LineBot</a>
                  <a href="program.html">VPython</a>
              </div>
          </li>
          <li class="dropdown"><a href="javascript:void(0)" class="dropbtn" onclick="myFunction2()">線上題庫</a>
              <div class="dropdown-content" id="myDropdown2">
                  <a href="phyhistorytest.html">物理史小測驗</a>
                  <a href="phystest.html">高中物理題目</a>
                  <a href="https://guidephy.github.io/taigitest.html">台羅拼音聽力測驗</a>
              </div>
          </li>

          
          <li class="dropdown"><a href="javascript:void(0)" class="dropbtn" onclick="myFunction3()">作品分享</a>
              <div class="dropdown-content" id="myDropdown3">
                  <a href="https://guidephy.github.io/vrguanyin/">VR遊觀音</a>
                  <a href="https://guidephy.github.io/EnergyTransition/">Planet285計畫</a>
                  <a href="https://guidephy.github.io/imagetotext/">影像擷取文字系統</a>
                  <a href="https://guidephy.github.io/taigitest.html">台羅拼音聽力測驗</a>
              </div>

          </li>
          
          <li><a href="#">讀書心得</a></li>
        </ul>
        </ul>
      </nav>
    </header>

  </div>
  
    <div class="wrapper">
      <h2 class="page-title">LineBot</h2>
    </div>

  <div class="news-contents wrapper">
    <article>
      <header class="post-info">
        <h2  class="post-title">LineBot第五堂課</h2>
        
        <p class="post-date">4/13 <span>2022</span></p>
        <p class="post-cat">類別：程式教學</p>
      </header>

     <h3>LineBot與google試算表的結合</h3><br>
     <p>1、先至google雲端硬碟新增一個google試算表。</p>
      <div style="text-align:center;">
      <img src="images/LineBot/LineBot-5-1.png"  alt=""><br>
      </div>
     <p>2、點擊左上角的「無標題的試算表」為此試算表命名，命什麼名字都可以，不影響程式編寫。</p>

     <p>3、點擊右上角的「 共用」，將共用權限改為「開啟-任何知道連結的使用者」。</p>

     <p>4、下方工作列的名稱先保留原本的名字「工作表1」，此資訊在後面的程式會用到。</p>
      <div style="text-align:center;">
      <img src="images/LineBot/LineBot-5-2.png"  alt=""><br>
      </div>
      <div style="text-align:center;">
      <img src="images/LineBot/LineBot-5-3.png"  alt=""><br>
      </div>

      <p>5、查看此時您google試算表的網址，在 d/  和 /edit中間的一串英文與數字為此試算表的ID，<br>
      以下圖為例，ID為1b8RxFa5Fj1JXmTOZ4gUTuQa3R2mU2OprJfM3SMuwvVQ，<br>
      此ID在後面的程式會用到。</p>
      <div style="text-align:center;">
      <img src="images/LineBot/LineBot-5-4.png"  alt=""><br>
      </div>
      <p>6、回到單元3已建立好google apps script的程式碼，<br>
      在 var channel_access_token = "你的Linebot的channel access token" 的下面新增4行程式碼，<br>
             記得將"你的試算表ID" 改成第5步中你的試算表的ID。<br>

            var ss = SpreadsheetApp.openById("你的試算表ID"); //試算表ID<br>

            var sheet = ss.getSheetByName("工作表1"); //要讀取工作列的名稱<br>

            var data = sheet.getRange(2,1);  //存對話資料的儲存格 (2,1)表示為試算表的A2<br>

            var reply = sheet.getRange(3,4).getValue(); //預設要回話資料的儲存格 (3,4)表示為試算表的D3</p>
      <div style="text-align:center;">
      <img src="images/LineBot/LineBot-5-5.png"  alt=""><br>
      </div>
      <p>7、將原程式中的push_message(ME,event.message.text); <br>
      改為data.setValue(event.message.text);<br>
      push_message(ME,reply); </p>
      <div style="text-align:center;">
      <img src="images/LineBot/LineBot-5-6.png"  alt=""><br>
      </div>

      <p> 8、點選「發佈」中的「佈署為網路應用程式......」，<br>專案版本記得一定要選「新增」再更新才會真的更新。</p>
      <div style="text-align:center;">
      <img src="images/LineBot/LineBot-5-7.png"  alt=""><br>
      </div>

      <p>9、此次修改程式碼的目的是當在LineBot上送出對話後，<br>
           將對話存在試算表的A2格中<br>
           然後LineBot會回應在試算表D3格的文字<br>
           請檢查A2格是不是有記錄剛打在LineBot上的文字<br>
           另外，可更改D3內的文字，看LineBot是不是會回應該內容</p>
      <div style="text-align:center;">
      <img src="images/LineBot/LineBot-5-8.png"  alt=""><br>
      </div>
      <p>可試著改不同的儲存格儲存和回應對話。</p>




    </article>

    <aside>
      <h3 class="sub-title">類別</h3>
      <ul class="sub-menu">
         <li><a href="physcis.html">物理學習</a></li>
         <li><a href="program.html">程式語言</a></li>
         <li><a href="exp.html">科學實驗</a></li>
         <li><a href="#">讀書心得</a></li>
      </ul>

      <h3 class="sub-title">About Me</h3>
      <p>
       Guidephy學習教室提供物理及程式語言的學習分享，希望學生能透過這裡的學習資源，達到有效的學習。
      </p>
    </aside>



  </div>

  <footer>
    <div class="wrapper">
      <p><small>&copy; 觀音高中物理科 林仟弘老師</small></p>
    </div>
  </footer>

</body>
</html>
