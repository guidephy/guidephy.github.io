<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>高中物理素養題</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background-color: #F0F4F8;
            color: #2D3748;
        }
        #game-container {
            background-color: #FFFFFF;
            border: 3px solid #4A5568;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #2B6CB0;
            text-align: center;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        .blank {
            display: inline-block;
            width: 80px;
            height: 30px;
            border: 2px dashed #4A5568;
            text-align: center;
            line-height: 30px;
            margin: 0 5px;
            border-radius: 5px;
            background-color: #EDF2F7;
            transition: all 0.3s ease;
        }
        .blank:hover {
            background-color: #E2E8F0;
        }
        .answer-area {
            margin-top: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }
        .draggable {
            padding: 5px 10px;
            background-color: #EDF2F7;
            border: 2px solid #4A5568;
            cursor: move;
            touch-action: none;
            user-select: none;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        .draggable:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .dragging {
            opacity: 0.7;
        }
        #check-answer {
            display: block;
            margin: 20px auto;
            padding: 10px 20px;
            font-size: 16px;
            background-color: #4299E1;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        #check-answer:hover {
            background-color: #3182CE;
            transform: translateY(-2px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        #result {
            margin-top: 20px;
            font-weight: bold;
            text-align: center;
            color: #2B6CB0;
            min-height: 24px;
        }
        .correct {
            color: #38A169 !important;
            font-weight: bold;
        }
        #footer {
            margin-top: 20px;
            text-align: center;
        }
        #footer a {
            color: #2B6CB0;
            text-decoration: none;
        }
        #footer a:hover {
            text-decoration: underline;
        }
        #message {
            text-align: center;
            margin-top: 10px;
            font-style: italic;
            color: #718096;
        }

         #orientation-message {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #F0F4F8;
            color: #2D3748;
            text-align: center;
            padding-top: 50%;
            font-size: 1.5em;
            z-index: 1000;
        }

        @media screen and (max-width: 768px) and (orientation: portrait) {
            #orientation-message {
                display: block;
            }
            #game-container {
                display: none;
            }
        }

        .draggable {
            transition: transform 0.1s ease, opacity 0.1s ease;
        }

        .dragging {
            opacity: 0.7;
            transform: scale(1.05);
        }
    </style>
</head>
<body>
 <div id="orientation-message">
    請將設備轉至橫向以開始遊戲
</div>

<div id="game-container">
    <h1>高中物理素養題</h1>

    <div id="passage">
        在物理學中，基本交互作用是支配粒子間相互作用的四種基本力。這些基本力在自然界中扮演著不同的角色，並且它們的作用範圍和影響對象各不相同。首先，<span id="blank-1" class="blank" data-correct="重力"></span>是四種基本交互作用中一種作用範圍可達無窮遠的力，這使得它在星系形成中扮演了重要角色。相反，<span id="blank-2" class="blank" data-correct="弱力"></span>作用範圍極其微小，僅在亞原子粒子之間發揮作用，但它能夠使單獨的中子衰變為質子、電子和其他粒子，這一過程被稱為β衰變。至於原子內部的情況，電子繞著原子核運動主要是由於<span id="blank-3" class="blank" data-correct="電磁力"></span>的存在，而非重力作用。此外，在原子核內，質子與中子之間存在<span id="blank-4" class="blank" data-correct="強力"></span>，這種力使它們能夠穩定結合在一起，維持原子核的完整性。

        
    </div>

    <div id="answer-area" class="answer-area">
    </div>

    <button id="check-answer" onclick="checkAnswers()">確認答案</button>

    <div id="result"></div>
    <div id="message"></div>

    <div id="footer">
        <a href="https://guidephy.github.io/" target="_blank">@Guidephy</a>
    </div>
</div>
 
    <script>
       let draggingElement = null;

function handleDragStart(e) {
    this.classList.add('dragging');
    draggingElement = this;
    e.dataTransfer.effectAllowed = 'move';
    e.dataTransfer.setData('text/html', this.innerHTML);
    updateMessage('正在拖動答案...');

    requestAnimationFrame(() => {
        this.style.opacity = '0.7';
        this.style.transform = 'scale(1.05)';
    });
}

function handleDragOver(e) {
    if (e.preventDefault) {
        e.preventDefault();
    }
    e.dataTransfer.dropEffect = 'move';
    return false;
}


function handleDrop(e) {
    if (e.stopPropagation) {
        e.stopPropagation();
    }
    
    const target = e.target.closest('.blank') || e.target;
    
    if (draggingElement != target && !target.classList.contains('correct')) {
        if (target.textContent) {
            returnToPreviousPosition(target.textContent);
        }
        target.textContent = draggingElement.textContent;
        draggingElement.textContent = '';
        
        requestAnimationFrame(() => {
            draggingElement.style.visibility = 'hidden';
            target.classList.add('filled');
        });
        
        updateMessage('答案已放置！');
    }
    return false;
}

function handleDragEnd() {
    this.classList.remove('dragging');
    
    requestAnimationFrame(() => {
        this.style.opacity = '';
        this.style.transform = '';
    });
    
    updateMessage('');
}

function handleTouchStart(e) {
    const touch = e.touches[0];
    draggingElement = this;
    this.classList.add('dragging');
    this.style.position = 'absolute';
    this.style.zIndex = 1000;
    moveAt(touch.pageX, touch.pageY);
    updateMessage('正在移動答案...');
}

function handleTouchMove(e) {
    e.preventDefault();
    if (!draggingElement) return;
    const touch = e.touches[0];
    moveAt(touch.pageX, touch.pageY);
}

function handleTouchEnd(e) {
    if (!draggingElement) return;
    draggingElement.classList.remove('dragging');
    draggingElement.style.position = '';
    draggingElement.style.zIndex = '';
    
    const touch = e.changedTouches[0];
    const blank = document.elementFromPoint(touch.pageX, touch.pageY);
    
    if (blank && (blank.classList.contains('blank') || blank.closest('.blank'))) {
        const targetBlank = blank.classList.contains('blank') ? blank : blank.closest('.blank');
        if (!targetBlank.classList.contains('correct')) {
            if (targetBlank.textContent) {
                returnToPreviousPosition(targetBlank.textContent);
            }
            targetBlank.textContent = draggingElement.textContent;
            draggingElement.style.visibility = 'hidden';
            targetBlank.classList.add('filled');
            updateMessage('答案已放置！');
        }
    } else {
        draggingElement.style.visibility = 'visible';
        updateMessage('');
    }
    draggingElement = null;
}

function moveAt(pageX, pageY) {
    draggingElement.style.left = pageX - draggingElement.offsetWidth / 2 + 'px';
    draggingElement.style.top = pageY - draggingElement.offsetHeight / 2 + 'px';
}

function returnToPreviousPosition(text) {
    const options = document.querySelectorAll('.draggable');
    for (let option of options) {
        if (option.getAttribute('data-answer') === text && !option.textContent) {
            option.textContent = text;
            option.style.visibility = 'visible';
            return;
        }
    }
    // 如果沒有找到空的選項，創建一個新的
    createNewOption(text);
}

function createNewOption(text) {
    const answerArea = document.getElementById('answer-area');
    const div = document.createElement('div');
    div.className = 'draggable';
    div.draggable = true;
    div.setAttribute('data-answer', text);
    div.textContent = text;
    answerArea.appendChild(div);
    addEventListenersToElement(div);
}

function addEventListenersToElement(element) {
    element.addEventListener('dragstart', handleDragStart);
    element.addEventListener('dragend', handleDragEnd);
    element.addEventListener('touchstart', handleTouchStart);
    element.addEventListener('touchmove', handleTouchMove);
    element.addEventListener('touchend', handleTouchEnd);
}

function checkAnswers() {
    const blanks = document.querySelectorAll('.blank');
    let allCorrect = true;
    let correctCount = 0;
    blanks.forEach(blank => {
        const correct = blank.dataset.correct;
        const answer = blank.textContent.trim();
        if (correct === answer) {
            blank.classList.add('correct');
            correctCount++;
        } else {
            allCorrect = false;
            if (answer) {
                returnToPreviousPosition(answer);
                blank.textContent = '';
                blank.classList.remove('filled');
            }
        }
    });
    const resultElement = document.getElementById('result');
    if (allCorrect) {
        resultElement.textContent = '恭喜你！所有答案都正確！';
        resultElement.style.color = '#38A169';
    } else {
        resultElement.textContent = `答對了 ${correctCount} 題，繼續加油！`;
        resultElement.style.color = '#2B6CB0';
    }
    updateMessage('答案已檢查，請繼續完成題目。');
}

function updateMessage(text) {
    document.getElementById('message').textContent = text;
}

function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

function createAnswerOptions() {
    const answerArea = document.getElementById('answer-area');
    const answers = [
        { id: 'option-1', answer: '重力' },
        { id: 'option-2', answer: '電磁力' },
        { id: 'option-3', answer: '強力' },
        { id: 'option-4', answer: '弱力' },
        { id: 'option-5', answer: '摩擦力' },
        { id: 'option-6', answer: '正向力' },
        { id: 'option-5', answer: '繩張力' },
        { id: 'option-6', answer: '彈力' },
        // 在這裡添加更多答案選項
    ];

    const shuffledAnswers = shuffleArray(answers);

    shuffledAnswers.forEach((item, index) => {
        const div = document.createElement('div');
        div.id = `option-${index + 1}`;
        div.className = 'draggable';
        div.draggable = true;
        div.setAttribute('data-answer', item.answer);
        div.textContent = item.answer;
        answerArea.appendChild(div);
    });
}

document.addEventListener('DOMContentLoaded', (event) => {
    createAnswerOptions();

    const draggables = document.querySelectorAll('.draggable');
    const blanks = document.querySelectorAll('.blank');

    draggables.forEach(addEventListenersToElement);

    blanks.forEach(blank => {
        blank.addEventListener('dragover', handleDragOver);
        blank.addEventListener('drop', handleDrop);
        blank.addEventListener('dragstart', handleDragStart);
    });


    function checkOrientation() {
        if (window.innerWidth <= 768 && window.innerHeight > window.innerWidth) {
            document.getElementById('orientation-message').style.display = 'block';
            document.getElementById('game-container').style.display = 'none';
        } else {
            document.getElementById('orientation-message').style.display = 'none';
            document.getElementById('game-container').style.display = 'block';
        }
    }

    checkOrientation();
    window.addEventListener('resize', checkOrientation);
});
    </script>
</body>
</html>