<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
  <title>物理小測驗</title>
 
    <link rel=stylesheet href=jquery.mobile-1.4.5.min.css>
    <script src=jquery-2.2.4.min.js></script>
    <script src=jquery.mobile-1.4.5.min.js></script>
    <script src="https://code.jquery.com/jquery-1.9.1.js"></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
  
    <body>  

    <div data-role="page">
      
      <div data-role="header" data-position="fixed">
        <h1>物理測驗</h1>
      </div>
      
      <div data-role="content">

        <div data-role="content">
        
          <h4 id="questionTitle"></h4>        
          <h4 id="question"></h4>
          <h4 id="chooseAnswer"></h4>
          <h3 id="spendtime" style="text-align:center;" style='visibility:hidden'><h3>
     
        <div  id="answer" data-role="controlgroup" data-type="vertical"  style='visibility:hidden'>
     
          <button id="answer1" onclick="check(this)"></button>
          <button id="answer2" onclick="check(this)"></button>
          <button id="answer3" onclick="check(this)"></button>
          <button id="answer4" onclick="check(this)"></button>

        </div>
        <div>
        <div  data-role="content">      
        <div id="forusername" data-role="fieldcontain">     
          <label  for="username">輸入姓名:</label>
          <input type="text"  style="text-align:center;" id="username">
        </div>
          <button id="sendBtn">開始測驗</button>
          <p id="timer" style='visibility:hidden'><p>
        </div>
          <p id="correctAnswer" style='visibility:hidden'><p>
        </div>
 
        <div data-role="footer" data-position="fixed" data-theme="b">
          <h4>&copy;Guidephy</h4>
        </div>
      
        </div>     
     </body>
  

  
 <script> 
     var t;
     var x=[];
     var wrong;
      
      sendBtn = $('#sendBtn');
      show = $('#question');
      questionTitle= $('#questionTitle');    
      answer1=$('#answer1');
      answer2=$('#answer2');
      answer3=$('#answer3');
      answer4=$('#answer4');
      chooseAnswer=$('#chooseAnswer');
      correctAnswer=$('#correctAnswer');
   
      
     var times;
     var parameter = {};
   
     var myVar=setInterval(function(){myTimer()},1000);
     sendBtn.on('click',function() {
      if (document.getElementById("username").value==""){
         alert("請輪入姓名"); 
      }else{
        wrong=0;
        document.getElementById("username").style.visibility='hidden';
        document.getElementById("forusername").style.visibility='hidden';
        t=0;
        document.getElementById("spendtime").style.visibility='hidden';
        document.getElementById("spendtime").innerHTML="";
        chooseAnswer.text("");  

        

        var index = 1;
        while (index < 11) {
                       var flag = true;
                       var num = Math.floor(Math.random() * 83)+2;
                       for (var i in x) {
                       if (x[i] == num) {
                       flag = false;
                       }
                       }
                       if (flag == true) {
                       x[index] = num;
                       index++;
                       }
                    }

        times=1;
        parameter = {
            startRow: x[times],
            startColumn: 2
                    };
        
        
        $.get("https://script.google.com/macros/s/AKfycbyR7UthpPVF9nYWh2z4KP-aeut4dUCocxi8H6yMG2xC0tGMemU/exec", parameter, function(data) {
          if(!data){
            show.text('無資料');
          }else{
             var content=data.split(",");
             show.text(content[4]);
             answer1.text(content[0]);
             answer2.text(content[1]);
             answer3.text(content[2]);
             answer4.text(content[3]);
             questionTitle.text("題目"+times);
             chooseAnswer.text("請選擇答案");        
             sendBtn.text("再玩一次");  
             correctAnswer.text(content[5]);
      }
            document.getElementById("question").style.visibility='visible';
            document.getElementById("answer").style.visibility='visible';    
      });
         
        clearInterval(myVar);
        myVar=setInterval(function(){myTimer()},1000);
 
      function myTimer()
      {
         t=t+1;
        document.getElementById("timer").innerHTML="遊戲時間:"+t+"秒";
      }
      
      document.getElementById("sendBtn").style.visibility='hidden';
       
     }
     });
   
   function check(id) { 
            if(id.innerHTML==document.getElementById("correctAnswer").innerHTML&&times<10){
              times=times+1;
              
              parameter = {
              startRow: x[times],
              startColumn: 2
             };
      
          document.getElementById("answer").style.visibility='hidden'; 
          document.getElementById("question").style.visibility='hidden';
           alert("答對了，再來一題");  
          questionTitle.text("題目"+times);
          $.get("https://script.google.com/macros/s/AKfycbyR7UthpPVF9nYWh2z4KP-aeut4dUCocxi8H6yMG2xC0tGMemU/exec", parameter, function(data) {
          var content=data.split(",");
          show.text(content[4]);
          answer1.text(content[0]);
          answer2.text(content[1]);
          answer3.text(content[2]);
          answer4.text(content[3]);
 
          correctAnswer.text(content[5]);
  
          document.getElementById("answer").style.visibility='visible'; 
          document.getElementById("question").style.visibility='visible';  
          });
        
         }else if(id.innerHTML==document.getElementById("correctAnswer").innerHTML && times==10){
          var gametime=t;
          var correctRatio=100*(10-wrong)/10;
          correctRatio = correctRatio.toFixed(2);
     
          document.getElementById("answer").style.visibility='hidden'; 
          document.getElementById("question").style.visibility='hidden';
     
          questionTitle.text("");
          show.text("");
          answer1.text("");
          answer2.text("");
          answer3.text("");
          answer4.text("");
          document.getElementById("spendtime").style.visibility='visible';
          document.getElementById("spendtime").innerHTML=document.getElementById("username").value+"<br>恭喜你完成測驗，<br>此次測驗共花了"+gametime+"秒，<br>答對率="+correctRatio+"%";
          chooseAnswer.text(""); 
          document.getElementById("sendBtn").style.visibility='visible';
    }else{
      wrong=wrong+1;
      alert("答錯了");
    };
        }
 </script>
                                                                                                   
</html>